abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
axis(1,c(0.0002,0.0006,0.0002,0.001,0.01,0.02,0.10,0.5),
labels=c(0,0002,0.0006,0.0001,0.0002,0.001,0.01,0.02,0.1,0.5),line=0)
axis(1,c(0.0002,0.0006,0.0002,0.001,0.01,0.02,0.1,0.5),
labels=c(0,0002,0.0006,0.0002,0.001,0.01,0.02,0.1,0.5),line=0)
axis(1,     c(0.0002,0.0006,0.0002,0.001,0.01,0.02,0.1,0.5),
labels=c(0.0002,0.0006,0.0002,0.001,0.01,0.02,0.1,0.5),line=0)
mtext("Label 2",1,line=3,at=0.2,col="blue")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0006,0.0005,0.001,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0)
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0006,0.005,0.001,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0)
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0005,0.001,0.001,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0)
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0005,0.001,0.005,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0)
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0004,0.001,0.005,0.01,0.02,0.1,0.5)
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0004,0.001,0.004,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0)
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0004,0.001,0.004,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
allAJ[20:30,:]
allAJ[20:30,]
allAJ[1:30,1:11]
allAJ[1:30,1:10]
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0004,0.001,0.002,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
allAJ[1:30,1:10]
allAJ[100,1:10]
allAJ[50:60,1:10]
allAJ[101,1:10]
allAJ[510,1:10]
allAJ[500,1:10]
allAJ[501,1:10]
allAJ[5001,1:10]
allAJ[2001,1:10]
allAJ[2501,1:10]
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 1st and 2nd x-axis for willingness to pay lambda
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
ticks <- c(217207,92706,18007,-15193,-26813,-29303,-31295,-31694)
axis(1, ticks, labels=ticks,line=4) ; mtext("Willingness to pay (lambda)",1,line=6)
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
ticks <- c(217207,92706,18007,-15193,-26813,-29303,-31295,-31694)
axis(1, ticks, labels=ticks,line=4) ; mtext("Willingness to pay (lambda)",1,line=6)
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
par(mfrow=c(1,1),pty="m")
# plot(brca$Threshold,brca$NBgaincostless,log="x",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
#      xlab="Optimal Risk Threshold (R)",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c(217207,92706,18007,-15193,-26813,-29303,-31295,-31694)
axis(1, ticks, labels=lambdas,line=4) ; mtext("Willingness to pay (lambda)",1,line=6)
par(mar=c(5,4,4,2)+0.1)#mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c(217207,92706,18007,-15193,-26813,-29303,-31295,-31694)
axis(1, ticks, labels=lambdas,line=4) ; mtext("Willingness to pay (lambda)",1,line=6)
par(mar=c(3,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c(217207,92706,18007,-15193,-26813,-29303,-31295,-31694)
axis(1, ticks, labels=lambdas,line=4) ; mtext("Willingness to pay (lambda)",1,line=6)
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c(217207,92706,18007,-15193,-26813,-29303,-31295,-31694)
axis(1, ticks, labels=lambdas,line=4) ; mtext("Willingness to pay (lambda)",1,line=6)
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c(217207,92706,18007,-15193,-26813,-29303,-31295,-31694)
axis(1, ticks, labels=lambdas,line=4,cex.axis=0.8) ; mtext("Willingness to pay (lambda)",1,line=6)
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c(217207,92706,18007,-15193,-26813,-29303,-31295,-31694)
axis(1, ticks, labels=lambdas,line=4,cex.axis=0.9) ; mtext("Willingness to pay (lambda)",1,line=6)
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c("2$17207","$92706","$18007","-$15193","-$26813","-$29303","-$31295","-$31694")
axis(1, ticks, labels=lambdas,line=4,cex.axis=0.9) ; mtext("Willingness to pay (lambda)",1,line=6)
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c("$217207","$92706","$18007","-$15193","-$26813","-$29303","-$31295","-$31694")
axis(1, ticks, labels=lambdas,line=4,cex.axis=0.85) ; mtext("Willingness to pay (lambda)",1,line=6)
##
# PLOT FIGURE 1
##
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c("$217207","$92706","$18007","-$15193","-$26813","-$29303","-$31295","-$31694")
axis(1, ticks, labels=lambdas,line=4,cex.axis=0.85) ; mtext("Willingness to pay (lambda)",1,line=6)
# Save this figure
dev.copy2pdf(file="testcostsAJ.pdf")
embedFonts(file="testcostsAJ.pdf",outfile="testcostsAJ.pdf") #Needed for TexStudio to read fonts (looks fine in pdf file w/o needed to embed)
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c("$217207","$92706","$18007","-$15193","-$26813","-$29303","-$31295","-$31694")
axis(1, ticks, labels=lambdas,line=4,cex.axis=0.9) ; mtext("Willingness to pay (lambda)",1,line=6)
# Save this figure
dev.copy2pdf(file="testcostsAJ.pdf")
embedFonts(file="testcostsAJ.pdf",outfile="testcostsAJ.pdf") #Needed for TexStudio to read fonts (looks fine in pdf file w/o needed to embed)
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c("$217207","$92706","$18007","-$15193","-$26813","-$29303","-$31295","-$31694")
axis(1, ticks, labels=lambdas,line=4,cex.axis=0.95) ; mtext("Willingness to pay (lambda)",1,line=6)
# Save this figure
dev.copy2pdf(file="testcostsAJ.pdf")
embedFonts(file="testcostsAJ.pdf",outfile="testcostsAJ.pdf") #Needed for TexStudio to read fonts (looks fine in pdf file w/o needed to embed)
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c("$217207","$92706","$18007","-$15193","-$26813","-$29303","-$31295","-$31694")
axis(1, ticks, labels=lambdas,line=4,cex.axis=1) ; mtext("Willingness to pay (lambda)",1,line=6)
# Save this figure
dev.copy2pdf(file="testcostsAJ.pdf")
embedFonts(file="testcostsAJ.pdf",outfile="testcostsAJ.pdf") #Needed for TexStudio to read fonts (looks fine in pdf file w/o needed to embed)
par(mar=c(7,4,4,2)+0.1) #mgp=c(2.2,1,0)) # Make space at bottom for 2nd x-axis for lambda
par(mfrow=c(1,1),pty="m")
brca$NBgaincostless <- brca$NetBenefit-pmax(0,brca$NBalwaysact)
plot(brca$Threshold,brca$NBgaincostless,log="x",xaxt="n",xlim=c(0.0002,0.5),type="l",ylim=c(-0.01,0.01),lty=2,
xlab="",ylab="Net Benefit gain from DCA",main="NB gain from DCA")
abline(h=0)
abline(v=brca$BRCAprev[2],lty=3)
text(0.05,-0.01,"If NB_Gain<0,\nthen test none",cex=0.9,pos=4)
text(brca$BRCAprev[2],-0.01,"If NB_Gain<0,\nthen test all",cex=0.9,pos=2)
# add 1st x-axis for optimal risk thresholds R
ticks <- c(0.0002,0.0004,0.001,0.003,0.01,0.02,0.1,0.5)
axis(1, ticks, labels=ticks,line=0) ; mtext("Optimal Risk Threshold (R)",1,line=2)
# Define the NBgain for a costing screening test
brca$NBgainwithcost <- brca$NBgaincostless-C_AJ[1]/allAJ$e
lines(brca$Threshold,brca$NBgainwithcost,lty=1)
legend(2e-04,0.011,lty=c(2,1),bty="n",
legend=c("Ignoring screening test cost","With screening test cost"),cex=1)
# add 2nd x-axis for willingness to pay lambda
lambdas <- c("+$217207","+$92706","+$18007","-$15193","-$26813","-$29303","-$31295","-$31694")
axis(1, ticks, labels=lambdas,line=4,cex.axis=1) ; mtext("Willingness to pay (lambda)",1,line=6)
# Save this figure
dev.copy2pdf(file="testcostsAJ.pdf")
embedFonts(file="testcostsAJ.pdf",outfile="testcostsAJ.pdf") #Needed for TexStudio to read fonts (looks fine in pdf file w/o needed to embed)
